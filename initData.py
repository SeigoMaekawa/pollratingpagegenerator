# -*- coding: utf-8 -*-
'''
Created on 2014/07/24

@author: seigo
'''

from google.appengine.api import users
from google.appengine.ext import webapp
from MyModel import HistoricalTable, PollRating, Government
from datetime import datetime

hts = [["2014/7/1","集団的自衛権行使容認の閣議決定","http://www.47news.jp/47topics/e/254919.php"],["2014/3/18","ロシア、クリミアを編入","http://www.47news.jp/CN/201403/CN2014031801002413.html"],["2014/2/9","舛添氏が圧勝、東京都知事選","http://www.47news.jp/CN/201402/CN2014020901001630.html"],["2014/1/7","国家安全保障局を設置","http://www.47news.jp/CN/201401/CN2014010701001086.html"],["2013/12/26","安倍首相が靖国神社参拝","http://www.47news.jp/CN/201312/CN2013122601000987.html"],["2013/12/6","特定秘密保護法が成立","http://www.47news.jp/CN/201312/CN2013120601002724.html"],["2013/11/3","東北楽天がプロ野球日本一","http://www.47news.jp/CN/201311/CN2013110301002118.html"],["2013/10/1","消費税率引き上げ決定、４月８％","http://www.47news.jp/CN/201310/CN2013100101002292.html"],["2013/9/8","２０２０年東京五輪開催決定","http://www.47news.jp/CN/201309/CN2013090401001495.html"],["2013/7/21","参院選で自民圧勝、ねじれ解消","http://www.47news.jp/CN/201307/CN2013072101001638.html"],["2013/3/15","ＴＰＰ交渉に参加表明","http://www.47news.jp/CN/201303/CN2013031501001566.html"],["2013/2/12","北朝鮮が３度目の核実験","http://www.47news.jp/CN/201302/CN2013021201001987.html"],["2013/1/16","アルジェリア人質事件発生","http://www.47news.jp/CN/201301/CN2013011601001649.html"],["2012/12/26","第２次安倍内閣発足","http://www.47news.jp/CN/201212/CN2012122601001577.html"],["2012/12/6","自公が政権奪還、衆院選","http://www.47news.jp/CN/201212/CN2012121601001041.html"],["2012/11/15","習近平新指導部発足、中国","http://www.47news.jp/CN/201211/CN2012111501001203.html"],["2012/11/6","オバマ米大統領が再選","http://www.47news.jp/CN/201211/CN2012110701000867.html"],["2012/10/1","新型輸送機オスプレイを沖縄配備","http://www.47news.jp/CN/201210/CN2012100101001335.html"],["2012/9/11","尖閣諸島の魚釣島など３島国有化","http://www.47news.jp/CN/201209/CN2012091101001254.html"],["2012/8/10","消費税増税法が成立、１０％へ","http://www.47news.jp/CN/201208/CN2012081001002702.html"],["2012/6/27","東京電力を国有化、公的資金注入","http://www.47news.jp/CN/201206/CN2012062701001601.html"],["2011/12/19","北朝鮮の金正日総書記が死去発表","http://www.47news.jp/CN/201112/CN2011121901001386.html"],["2011/11/27","大阪ダブル選で「維新の会」勝利","http://www.47news.jp/CN/201111/CN2011112701001230.html"],["2011/10/20","リビアのカダフィ大佐が死亡","http://www.47news.jp/CN/201110/CN2011102001000912.html"],["2011/10/5","米アップル創業者ジョブズ氏死去","http://www.47news.jp/CN/201110/CN2011100601000102.html"],["2011/9/2","野田内閣が発足","http://www.47news.jp/CN/201109/CN2011090201000656.html"],["2011/8/19","円が戦後最高値更新、75円95銭","http://www.47news.jp/CN/201108/CN2011081901001116.html"],["2011/7/17","なでしこジャパン女子Ｗ杯初優勝","http://www.47news.jp/CN/201107/CN2011071801000025.html"],["2011/5/6","首相、浜岡原発停止要請","http://www.47news.jp/CN/201105/CN2011050601000847.html"],["2011/3/11","東日本大震災","http://www.47news.jp/CN/201103/CN2011031101000455.html"],["2011/2/22","ＮＺ地震、日本人２８人も死亡","http://www.47news.jp/CN/201104/CN2011040401001017.html"],["2011/1/31","民主党小沢一郎元代表を強制起訴","http://www.47news.jp/CN/201101/CN2011013101000352.html"],["2010/11/23","北朝鮮が韓国・延坪島砲撃","http://www.47news.jp/CN/201011/CN2010112301000213.html"],["2010/10/6","ノーベル化学賞に根岸、鈴木両氏","http://www.47news.jp/CN/201010/CN2010100601000811.html"],["2010/9/15","政府が為替介入、６年半ぶり","http://www.47news.jp/CN/201009/CN2010091501000138.html"],["2010/9/7","尖閣で中国漁船が巡視船に衝突","http://www.47news.jp/CN/201009/CN2010090701000382.html"],["2010/7/11","参院選で民主党大敗、ねじれ国会","http://www.47news.jp/CN/201007/CN2010071101000032.html"],["2010/6/8","鳩山首相退陣、菅内閣発足","http://www.47news.jp/CN/201006/CN2010060801000756.html"],["2010/5/28","普天間移設で日米合意","http://www.47news.jp/CN/201005/CN2010052801000165.html"],["2010/4/20","宮崎県で口蹄疫、被害拡大","http://www.47news.jp/CN/201004/CN2010042001000207.html"],["2009/11/20","デフレ宣言、３年５カ月ぶり","http://www.47news.jp/CN/200911/CN2009112001000267.html"],["2009/10/2","２０１６年五輪はリオ、東京落選","http://www.47news.jp/CN/200910/CN2009100201000542.html"],["2009/9/16","鳩山内閣発足","http://www.47news.jp/CN/200909/CN2009091601000915.html"],["2009/8/30","民主党圧勝で政権交代、衆院選","http://www.47news.jp/CN/200908/CN2009083001000015.html"],["2009/8/3","全国初の裁判員裁判、東京地裁","http://www.47news.jp/CN/200908/CN2009080301000461.html"],["2009/6/25","歌手Ｍ・ジャクソンさん急死","http://www.47news.jp/CN/200906/CN2009062601000067.html"],["2009/5/25","北朝鮮が２回目の核実験","http://www.47news.jp/CN/200905/CN2009052501000261.html"],["2009/3/23","ＷＢＣで「侍ジャパン」が連覇","http://www.47news.jp/CN/200903/CN2009032401000025.html"],["2009/1/20","米、オバマ新政権が発足","http://www.47news.jp/CN/200901/CN2009012001000945.html"],["2008/10/31","田母神俊雄航空幕僚長を更迭","http://www.47news.jp/CN/200810/CN2008103101000632.html"],["2008/9/24","麻生内閣発足","http://www.47news.jp/CN/200809/CN2008092401000025.html"],["2008/9/15","リーマン・ショック","http://www.47news.jp/CN/200809/CN2008091501000215.html"],["2008/9/1","福田首相、退陣表明","http://www.47news.jp/CN/200809/CN2008090101000736.html"],["2008/7/7","北海道・洞爺湖サミット～９日","http://www.47news.jp/CN/200807/CN2008070901000704.html"],["2008/6/11","福田首相の問責決議が可決","http://www.47news.jp/CN/200806/CN2008061101000609.html"],["2008/5/12","中国・四川大地震","http://www.47news.jp/CN/200805/CN2008051201000871.html"],["2008/4/9","日銀総裁に白川副総裁が昇格","http://www.47news.jp/CN/200804/CN2008040901000924.html"],["2008/2/19","海自イージス艦が漁船と衝突","http://www.47news.jp/CN/200802/CN2008021901000329.html"],["2008/1/27","大阪府知事選で橋下徹氏初当選","http://www.47news.jp/CN/200801/CN2008012801000076.html"],["2007/11/28","防衛装備疑惑で前防衛次官を逮捕","http://www.47news.jp/CN/200711/CN2007112801000463.html"],["2007/11/2","テロ特措法期限切れ海自撤収命令","http://www.47news.jp/CN/200710/CN2007102901000620.html"],["2007/9/12","安倍首相が退陣。後任に福田氏","http://www.47news.jp/CN/200709/CN2007091201000426.html"],["2007/7/29","参院選で自民党が歴史的惨敗","http://www.47news.jp/CN/200707/CN2007072901000697.html"],["2007/5/28","松岡農相が自殺","http://www.47news.jp/CN/200705/CN2007052801000693.html"],["2007/5/14","改憲手続き定めた国民投票法成立","http://www.47news.jp/CN/200705/CN2007051401000231.html"]]
prs = [["2007/4/16","38.3 ","17.5 ","44.2 "],["2007/5/12","38.2 ","14.2 ","47.6 "],["2007/6/1","48.7 ","15.5 ","35.8 "],["2007/7/30","59.0 ","12.0 ","29.0 "],["2007/8/27","45.5 ","14.0 ","40.5 "],["2007/9/13","46.6 ","7.9 ","45.5 "],["2007/9/25","25.6 ","16.6 ","57.8 "],["2007/10/27","29.6 ","20.2 ","50.2 "],["2007/11/5","36.6 ","16.4 ","47.0 "],["2007/12/15","47.6 ","17.1 ","35.3 "],["2008/1/11","42.8 ","15.8 ","41.4 "],["2008/2/9","44.6 ","19.9 ","35.5 "],["2008/3/15","50.6 ","16.0 ","33.4 "],["2008/4/4","59.6 ","13.8 ","26.6 "],["2008/5/1","66.6 ","13.6 ","19.8 "],["2008/6/12","60.2 ","14.8 ","25.0 "],["2008/7/11","53.5 ","19.7 ","26.8 "],["2008/8/1","48.2 ","20.4 ","31.5 "],["2008/9/2","28.0 ","4.1 ","67.9 "],["2008/9/24","32.9 ","18.5 ","48.6 "],["2008/10/18","39.0 ","18.5 ","42.5 "],["2008/11/8","42.1 ","16.9 ","40.9 "],["2008/12/6","61.4 ","13.2 ","25.4 "],["2009/1/10","70.2 ","10.6 ","19.2 "],["2009/2/7","70.9 ","11.0 ","18.1 "],["2009/2/17","76.6 ","10.0 ","13.4 "],["2009/3/7","70.8 ","13.2 ","16.0 "],["2009/3/25","63.4 ","12.8 ","23.7 "],["2009/4/28","56.2 ","14.2 ","29.6 "],["2009/5/11","55.1 ","16.9 ","28.0 "],["2009/5/16","60.2 ","13.5 ","26.2 "],["2009/6/13","70.5 ","12.0 ","17.5 "],["2009/7/3","60.9 ","15.7 ","23.4 "],["2009/9/16","13.1 ","14.9 ","72.0 "],["2009/10/31","22.9 ","15.3 ","61.8 "],["2009/11/28","25.1 ","11.2 ","63.6 "],["2009/12/25","38.1 ","14.7 ","47.1 "],["2010/1/10","33.2 ","16.0 ","50.8 "],["2010/1/17","44.1 ","14.4 ","41.5 "],["2010/2/5","45.1 ","13.5 ","41.4 "],["2010/3/6","48.9 ","14.8 ","36.4 "],["2010/4/3","53.3 ","13.7 ","33.0 "],["2010/4/28","64.4 ","14.9 ","20.7 "],["2010/5/29","73.1 ","7.7 ","19.1 "],["2010/6/4","37.2 ","5.2 ","57.7 "],["2010/7/12","52.2 ","11.5 ","36.2 "],["2010/8/7","44.8 ","16.5 ","38.7 "],["2010/8/27","36.2 ","15.7 ","48.1 "],["2010/9/9","31.5 ","13.8 ","54.7 "],["2010/9/17","21.2 ","14.3 ","64.5 "],["2010/10/5","36.6 ","15.8 ","47.6 "],["2010/11/6","48.6 ","18.7 ","32.7 "],["2010/11/23","61.9 ","14.5 ","23.6 "],["2010/12/25","67.0 ","9.4 ","23.7 "],["2011/1/14","53.9 ","13.9 ","32.1 "],["2011/2/11","63.3 ","16.7 ","19.9 "],["2011/3/26","55.6 ","16.1 ","28.3 "],["2011/4/29","58.6 ","14.5 ","26.8 "],["2011/5/14","57.3 ","14.6 ","28.1 "],["2011/6/28","61.1 ","15.6 ","23.2 "],["2011/7/23","70.6 ","12.3 ","17.1 "],["2011/8/20","70.0 ","14.2 ","15.8 "],["2011/9/2","18.1 ","19.1 ","62.7 "],["2011/10/1","27.8 ","17.6 ","54.6 "],["2011/11/5","34.3 ","18.6 ","47.1 "],["2011/12/3","40.3 ","15.1 ","44.6 "],["2012/1/7","50.6 ","13.7 ","35.7 "],["2012/1/13","47.8 ","16.4 ","35.8 "],["2012/2/18","55.2 ","15.8 ","29.0 "],["2012/3/19","50.2 ","18.2 ","31.6 "],["2012/4/28","60.0 ","13.6 ","26.4 "],["2012/5/26","58.1 ","13.9 ","28.0 "],["2012/6/4","50.0 ","18.0 ","32.0 "],["2012/6/26","54.4 ","15.8 ","29.9 "],["2012/7/14","59.9 ","11.9 ","28.2 "],["2012/8/11","59.0 ","13.1 ","27.9 "],["2012/9/1","59.4 ","14.3 ","26.3 "],["2012/10/1","55.3 ","15.5 ","29.2 "],["2012/11/3","66.0 ","16.2 ","17.7 "],["2012/12/26","21.8 ","16.2 ","62.0 "],["2013/1/26","22.1 ","11.2 ","66.7 "],["2013/2/23","16.2 ","11.1 ","72.7 "],["2013/3/23","16.7 ","12.2 ","71.1 "],["2013/3/30","20.8 ","7.2 ","72.0 "],["2013/4/20","16.0 ","11.9 ","72.1 "],["2013/5/18","16.2 ","12.9 ","70.9 "],["2013/6/1","16.3 ","15.7 ","68.0 "],["2013/6/8","20.4 ","8.4 ","71.2 "],["2013/7/22","31.7 ","12.1 ","56.2 "],["2013/8/24","25.6 ","16.7 ","57.7 "],["2013/9/14","20.4 ","17.8 ","61.8 "],["2013/9/28","21.8 ","7.5 ","70.7 "],["2013/10/1","24.1 ","12.6 ","63.3 "],["2013/10/26","27.0 ","12.3 ","60.7 "],["2013/11/23","26.2 ","15.9 ","57.9 "],["2013/12/8","38.4 ","14.0 ","47.6 "],["2013/12/14","35.9 ","7.2 ","56.9 "],["2013/12/22","33.0 ","12.8 ","54.2 "],["2013/12/28","32.6 ","12.2 ","55.2 "],["2014/1/25","31.0 ","13.1 ","55.9 "],["2014/2/22","29.7 ","16.4 ","53.9 "],["2014/4/11","26.7 ","13.5 ","59.8 "],["2014/5/17","32.5 ","12.8 ","54.7 "],["2014/6/21","33.0 ","14.9 ","52.1 "],["2014/7/1","40.6 ","11.6 ","47.8 "]]
gos = [["野田","2011/09/02","2012/12/26"],["菅","2010/06/08","2011/09/02"],["鳩山","2009/09/16","2010/06/08"],["麻生","2008/09/24","2009/09/16"],["福田","2007/09/26","2008/09/24"],["安倍","2007/04/01","2007/09/26"]]


class initDATA(webapp.RequestHandler):
    '''
    classdocs
    '''
    def get(self):
        user = users.get_current_user()
        if user == None:
            self.redirect(users.create_login_url(self.request.uri))
            return
        for ht in hts:
            htdate = datetime.date(datetime.strptime(ht[0], '%Y/%m/%d'))
            obj1 = HistoricalTable(date=htdate,title=ht[1],url=ht[2])
            obj1.save()
            
        for pr in prs:
            prdate = datetime.date(datetime.strptime(pr[0], '%Y/%m/%d'))
            obj2 = PollRating(date=prdate,approval_rate=float(pr[3]),unknown_rate=float(pr[2]),disapproval_rate=float(pr[1]))
            obj2.save()
        
        for pgo in gos:
            gosdate = datetime.date(datetime.strptime(pgo[1], '%Y/%m/%d'))
            try:
                goedate = datetime.date(datetime.strptime(pgo[2], '%Y/%m/%d'))
            except:
                goedate = None
            obj3 = Government(name=pgo[0], begin=gosdate, end=goedate)
            obj3.save()
            
class clearDATA(webapp.RequestHandler):
    def get(self):
        user = users.get_current_user()
        if user == None:
            self.redirect(users.create_login_url(self.request.uri))
            return
        for ht in HistoricalTable.all():
            ht.delete()
        
        for pr in PollRating.all():
            pr.delete()
            
        for pgo in Government.all():
            pgo.delete()
        
        
            